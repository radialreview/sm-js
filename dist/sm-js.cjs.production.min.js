"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("lodash"),r=e(require("chance")),n=require("@apollo/client/core"),o=e(require("react")),a=require("@apollo/client/link/ws"),i=require("@apollo/client/link/http"),u=require("@apollo/client/link/batch-http"),s=require("@apollo/client/utilities"),c=require("@apollo/client");function l(e,t,r,n,o,a,i){try{var u=e[a](i),s=u.value}catch(e){return void r(e)}u.done?t(s):Promise.resolve(s).then(n,o)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){l(a,n,o,i,u,"next",e)}function u(e){l(a,n,o,i,u,"throw",e)}i(void 0)}))}}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function f(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,h(e,t)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function v(e,t,r){return(v=g()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&h(o,r.prototype),o}).apply(null,arguments)}function b(e){var t="function"==typeof Map?new Map:void 0;return(b=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return v(e,arguments,y(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),h(r,e)})(e)}function m(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)t.indexOf(r=a[n])>=0||(o[r]=e[r]);return o}function _(e,t){return t||(t=e.slice(0)),e.raw=t,e}var E,O,x=function(e){function t(t){var r;return(r=e.call(this,'NotUpToDate exception - The property "'+t.propName+'" on the DO for the node type '+t.nodeType+" was read but is not guaranteed to be up to date. Add that property to the query with the id "+t.queryId)||this).propName=void 0,r.propName=t.propName,r}return f(t,e),t}(b(Error)),D=function(e){function t(t){return e.call(this,'NotUpToDateInComputed exception - The property "'+t.propName+'" on the DO for the node type "'+t.nodeType+'" was read for the computed property "'+t.computedPropName+'" but is not guaranteed to be up to date. Add that property to the query with the id '+t.queryId)||this}return f(t,e),t}(b(Error)),P=function(e){function t(t){return e.call(this,"FilterPropertyNotDefinedInQueryException exception - The filter property '"+t.filterPropName+"' is not defined in the 'map' function of the queryDefinition. Add that property to the queryDefinition 'map' function.")||this}return f(t,e),t}(b(Error)),w=function(e){function t(t){return e.call(this,"SortPropertyNotDefinedInQueryException exception - The sort property '"+t.sortPropName+"' is not defined in the 'map' function of the queryDefinition. Add that property to the queryDefinition 'map' function.")||this}return f(t,e),t}(b(Error)),q=function(e){function t(t){return e.call(this,'ImpliedPropertyException exception - The property "'+t.propName+'" is implied and cannot be customized within a node definition.')||this}return f(t,e),t}(b(Error)),S=function(e){function t(t){return e.call(this,'NotCached exception - Attempted to get the node with the type "'+t.nodeType+'" and id "'+t.id+'" but it was not cached.')||this}return f(t,e),t}(b(Error)),N=function(e){function t(t){return e.call(this,"NodesCollectionPageOutOfBoundsException - page '"+t.page+"' does not exist.")||this}return f(t,e),t}(b(Error)),R=function(e){function t(t){return e.call(this,"DataType exception - the data type "+t.dataType+' received a bad value. Value: "'+t.value+'"')||this}return f(t,e),t}(b(Error)),T=function(e){function t(t){return e.call(this,"DataTypeExplicitDefaultException - the data type "+t.dataType+" requires setting an explicit default value for non-optional properties")||this}return f(t,e),t}(b(Error)),A=function(e){function t(t){return e.call(this,"DataParsing exception - "+t.message+"\nData: "+JSON.stringify(t.receivedData,null,2)+".")||this}return f(t,e),t}(b(Error)),j=function(e){function t(t){var r;return(r=e.call(this,"UnexpectedSubscriptionMessage exception - unexpected subscription message received")||this).exception=void 0,r.exception=t,r}return f(t,e),t}(b(Error)),I=function(e){function t(t){return e.call(this,"FilterOperatorNotImplementedException - '"+t.operator+"' operator not implemented.")||this}return f(t,e),t}(b(Error)),k=function(e){function t(t){return e.call(this,"Unreachable case: "+("object"==typeof t?JSON.stringify(t,null,2):t))||this}return f(t,e),t}(b(Error));(E=exports.DATA_TYPES||(exports.DATA_TYPES={})).string="s",E.maybeString="mS",E.stringEnum="sE",E.maybeStringEnum="mSE",E.number="n",E.maybeNumber="mN",E.boolean="b",E.maybeBoolean="mB",E.object="o",E.maybeObject="mO",E.record="r",E.maybeRecord="mR",E.array="a",E.maybeArray="mA",(O=exports.RELATIONAL_TYPES||(exports.RELATIONAL_TYPES={})).oneToOne="oTO",O.oneToMany="otM";var C=function(e){var t;this.type=void 0,this.parser=void 0,this.boxedValue=void 0,this.defaultValue=void 0,this.isOptional=void 0,this.acceptableValues=void 0,this.type=e.type,this.parser=e.parser,this.boxedValue=e.boxedValue,this.defaultValue=null!=(t=e.defaultValue)?t:null,this.isOptional=e.isOptional,this.acceptableValues=e.acceptableValues},L=function(e){return new C({type:exports.DATA_TYPES.string,parser:function(e){return null!=e?String(e):e},defaultValue:e,isOptional:!1})};L._default=L(""),L.optional=new C({type:exports.DATA_TYPES.maybeString,parser:function(e){return null!=e?String(e):e},isOptional:!0});var F=function(e){return new C({type:exports.DATA_TYPES.stringEnum,parser:function(e){return null!=e?String(e):e},defaultValue:e[0],isOptional:!1,acceptableValues:e})};F.optional=function(e){return new C({type:exports.DATA_TYPES.maybeStringEnum,parser:function(e){return null!=e?String(e):null},defaultValue:e[0],isOptional:!0,acceptableValues:e})};var M=function e(t){return new C({type:exports.DATA_TYPES.number,parser:function(t){var r=Number(t);return isNaN(r)?(function(e){var t,r;if("production"!==(null==(t=process)||null==(r=t.env)?void 0:r.NODE_ENV))throw e;console.error(e)}(new R({dataType:exports.DATA_TYPES.number,value:t})),e._default.defaultValue):r},defaultValue:t,isOptional:!1})};M._default=M(0),M.optional=new C({type:exports.DATA_TYPES.maybeNumber,parser:function(e){return null!=e?Number(e):e},isOptional:!0});var U=function(e){return void 0===e?new T({dataType:exports.DATA_TYPES.boolean}):new C({type:exports.DATA_TYPES.boolean,parser:function(e){if("true"===e||!0===e)return!0;if("false"===e||!1===e)return!1;throw new R({dataType:exports.DATA_TYPES.boolean,value:e})},defaultValue:e,isOptional:!1})};U._default=U(),U.optional=new C({type:exports.DATA_TYPES.maybeBoolean,parser:function(e){return null==e?e:"true"===e||!0===e},isOptional:!0});var V=function(e){return new C({type:exports.DATA_TYPES.object,parser:function(e){return e},boxedValue:e,isOptional:!1})};V._default=null,V.optional=function(e){return new C({type:exports.DATA_TYPES.maybeObject,parser:function(e){return e},boxedValue:e,isOptional:!0})};var Q=function(e){return new C({type:exports.DATA_TYPES.record,parser:function(e){return e},boxedValue:e,isOptional:!1,defaultValue:{}})};Q.optional=function(e){return new C({type:exports.DATA_TYPES.maybeRecord,parser:function(e){return e},boxedValue:"function"==typeof e?e._default:e,isOptional:!0,defaultValue:null})},Q._default=null;var B={id:L,version:M,lastUpdatedBy:L,type:L},Y=p({},m(B,["type"]),{dateCreated:M,dateLastModified:M,lastUpdatedClientTimestamp:M}),K=Object.values({_gte:"_gte",_lte:"_lte",_eq:"_eq",_gt:"_gt",_lt:"_lt",_neq:"_neq",_contains:"_contains",_ncontains:"_ncontains"});function G(e){if(!e.startsWith("__JSON__"))throw Error("parseJSONFromBE - invalid json received:\n"+e);return e.startsWith("__JSON__[")?JSON.parse(e.replace("__JSON__","")):JSON.parse(e.replace("__JSON__","").replace(/\n/g,"\\n"))}function J(e){return"__NULL__"===e?null:"true"===e||"false"===e?"true"===e:"string"==typeof e&&e.startsWith("__JSON__")?G(e):Array.isArray(e)?e.map((function(e){return"object"==typeof e?J(e):e})):null!=e&&"object"==typeof e?(t=e,Object.keys(t).reduce((function(e,r){var n;return p({},e,((n={})[r]=J(t[r]),n))}),{})):e;var t}function z(e){var r={},n=e,o=function(e){var o=n[e],a=K.every((function(e){return t.isObject(o)&&!o.hasOwnProperty(e)}));if("object"==typeof n[e]&&null!==n[e]&&a){var i=z(o);for(var u in i)i.hasOwnProperty(u)&&(r[e+"."+u]=i[u])}else t.isObject(o)?r[e]=p({},o,{_condition:o._condition||"AND"}):void 0!==o&&(r[e]={_eq:o,_condition:"AND"})};for(var a in n)o(a);return r}var W,H=function(){function e(){var e=this;this.DOsById={},this.lastKnownPersistedDataById={},this.inFlightRequestsById={},this.onDOConstructed=function(t){if(!t.id)throw Error("No id found in DO");e.DOsById[t.id]=t},this.onDODeleted=function(t){if(!t.id)throw Error("No id found in DO");delete e.DOsById[t.id],delete e.lastKnownPersistedDataById[t.id]},this.onPersistedDataReceived=function(t){var r=t.data.id;e.inFlightRequestsById[r]?e.lastKnownPersistedDataById[r]=t.data:t.applyUpdateToDO()},this.onUpdateRequested=function(t){var r=e.getDOById(t.id);if(!r)return{onUpdateSuccessful:function(){},onUpdateFailed:function(){}};var n=p({},function e(t){if("object"!=typeof t||null==t)return t;if(Array.isArray(t)){var r=[];return t.forEach((function(t){return r.push(e(t))})),r}var n={};for(var o in t)n[o]=e(t[o]);return n}(r.persistedData),{version:r.version,lastUpdatedBy:r.lastUpdatedBy});e.inFlightRequestsById[t.id]?e.inFlightRequestsById[t.id].push({rollbackState:n}):(e.lastKnownPersistedDataById[t.id]=n,e.inFlightRequestsById[t.id]=[{rollbackState:n}]);var o=e.inFlightRequestsById[t.id].length-1,a=Number(r.version);return r.onDataReceived(p({},t.payload,{version:a+1})),{onUpdateFailed:function(){e.handleUpdateFailed({updateIdx:o,id:t.id})},onUpdateSuccessful:function(){e.handleUpdateSuccessful({updateIdx:o,id:t.id})}}}}var t=e.prototype;return t.handleUpdateFailed=function(e){var t=this.inFlightRequestsById[e.id];if(t.length===e.updateIdx+1){var r=this.getDOById(e.id);if(!r)return;t.length>1?r.onDataReceived(t[t.length-1].rollbackState,{__unsafeIgnoreVersion:!0}):(r.onDataReceived(this.lastKnownPersistedDataById[e.id],{__unsafeIgnoreVersion:!0}),t.splice(e.updateIdx,1))}t.splice(e.updateIdx,1),this.cleanupIfNoInFlightRequests(e.id)},t.handleUpdateSuccessful=function(e){this.inFlightRequestsById[e.id].splice(e.updateIdx,1),this.cleanupIfNoInFlightRequests(e.id)},t.getDOById=function(e){return this.DOsById[e]},t.cleanupIfNoInFlightRequests=function(e){this.inFlightRequestsById[e].length||(delete this.lastKnownPersistedDataById[e],delete this.inFlightRequestsById[e])},e}(),X=(function(e){var t=function(e){var t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",i=n.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var o=Object.create((t&&t.prototype instanceof d?t:d).prototype),a=new x(n||[]);return o._invoke=function(e,t,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return{value:void 0,done:!0}}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var u=_(i,r);if(u){if(u===l)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=c(e,t,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===l)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}(e,r,a),o}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var l={};function d(){}function p(){}function f(){}var y={};u(y,o,(function(){return this}));var h=Object.getPrototypeOf,g=h&&h(h(D([])));g&&g!==t&&r.call(g,o)&&(y=g);var v=f.prototype=d.prototype=Object.create(y);function b(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function m(e,t){var n;this._invoke=function(o,a){function i(){return new t((function(n,i){!function n(o,a,i,u){var s=c(e[o],e,a);if("throw"!==s.type){var l=s.arg,d=l.value;return d&&"object"==typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,i,u)}),(function(e){n("throw",e,i,u)})):t.resolve(d).then((function(e){l.value=e,i(l)}),(function(e){return n("throw",e,i,u)}))}u(s.arg)}(o,a,n,i)}))}return n=n?n.then(i,i):i()}}function _(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,_(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=c(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,l;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function D(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:P}}function P(){return{value:void 0,done:!0}}return p.prototype=f,u(v,"constructor",f),u(f,"constructor",p),p.displayName=u(f,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,u(e,i,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},b(m.prototype),u(m.prototype,a,(function(){return this})),e.AsyncIterator=m,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new m(s(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(v),u(v,i,"Generator"),u(v,o,(function(){return this})),u(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=D,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return i.type="throw",i.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,l):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),O(r),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;O(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:D(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}(W={exports:{}}),W.exports),$=new r;function Z(){return $.word()}function ee(){return $.bool()}function te(e,t){return $.integer({min:e,max:t})}var re=["to"],ne=["from"];function oe(e,t){var r=Object.entries(e).reduce((function(e,t){var r=t[0],n=t[1];if("childNodes"===r){if(!Array.isArray(n))throw new Error('"childNodes" is supposed to be an array');return p({},e,{childNodes:n.map((function(e){return oe(e)}))})}if("additionalEdges"===r){if(!Array.isArray(n))throw new Error('"additionalEdges" is supposed to be an array');return p({},e,{additionalEdges:n.map((function(e){return oe(function(e){if(e.hasOwnProperty("to")){var t=e.to;return p({},m(e,re),{targetId:t})}if(e.hasOwnProperty("from"))return p({},m(e,ne),{sourceId:e.from});throw new Error("convertEdgeDirectionNames - received invalid data")}(e),{skipBooleanStringWrapping:!0})}))})}return p({},e,ue({key:r,value:n}))}),{});return Object.entries(r).reduce((function(e,r,n){var o=r[0],a=r[1];return n>0&&(e+="\n"),"childNodes"===o||"additionalEdges"===o?e+(o+": [\n{\n")+a.join("\n}\n{\n")+"\n}\n]":e+(o+": ")+(null===a||("true"===a||"false"===a)&&null!=t&&t.skipBooleanStringWrapping?a:'"'+a+'"')}),"")}function ae(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n")}function ie(e,t){return Object.entries(e).reduce((function(e,r){var n=r[0],o=r[1],a=null!=t&&t.parentKey?t.parentKey+"__dot__"+n:n;return"object"!=typeof o||null==o||Array.isArray(o)?e=p({},e,ue(p({key:a,value:o},t))):(t&&t.omitObjectIdentifier||(e[a]="__object__"),e=p({},e,Object.entries(o).reduce((function(e,r){return p({},e,ue(p({key:a+"__dot__"+r[0],value:r[1]},t)))}),{}))),e}),{})}function ue(e){var t,r,n,o,a,i;if(null===e.value)return(t={})[e.key]=null,t;if(Array.isArray(e.value))return(r={})[e.key]="__JSON__"+ae(JSON.stringify(e.value)),r;if("object"==typeof e.value)return ie(((n={})[e.key]=e.value,n),{omitObjectIdentifier:e.omitObjectIdentifier});if("string"==typeof e.value)return(o={})[e.key]=ae(e.value),o;if("boolean"==typeof e.value||"number"==typeof e.value)return"number"==typeof e.value&&isNaN(e.value)?((i={})[e.key]=null,i):((a={})[e.key]=String(e.value),a);throw Error("I don't yet know how to handle feData of type \""+typeof e.value+'"')}function se(e){var t,r=p({},e.properties,(t=e.relational)?Object.keys(t).reduce((function(e,r){var n=t[r]();return e[r]=function(e){return p({},n(e),{_relationshipName:r})},e}),{}):{});return Object.keys(e.properties).forEach((function(t){var n=e.properties[t];n.type!==exports.DATA_TYPES.object&&n.type!==exports.DATA_TYPES.maybeObject||(r[t]=function(e){return e.map})})),e.mapFn(r)}function ce(e){var t=se({mapFn:e.mapFn,properties:e.data,relational:e.relational});return Object.keys(t||e.data).reduce((function(r,n){if(!e.data[n])return r;if(e.isRootLevel&&Object.keys(B).includes(n))return r;var o=e.data[n];return o.type===exports.DATA_TYPES.object||o.type===exports.DATA_TYPES.maybeObject?(r.push(n),r.push.apply(r,ce({queryId:e.queryId,mapFn:t&&"function"==typeof t[n]?t[n]:function(){return null},data:o.boxedValue}).map((function(e){return n+"__dot__"+e}))),r):[].concat(r,[n])}),e.isRootLevel?[].concat(Object.keys(B)):[])}function le(e){return Object.keys(e.nodeProperties).reduce((function(t,r){if(e.isRootLevel&&Object.keys(B).includes(r))return t;var n=e.nodeProperties[r];return n.type===exports.DATA_TYPES.object||n.type===exports.DATA_TYPES.maybeObject?(t.push(r),t.push.apply(t,le({nodeProperties:e.nodeProperties[r].boxedValue,isRootLevel:!1}).map((function(e){return r+"__dot__"+e}))),t):[].concat(t,[r])}),e.isRootLevel?[].concat(Object.keys(B)):[])}function de(e){var t={};return Object.keys(e.queryDefinitions).forEach((function(r){var n,o,a,i,u=e.queryDefinitions[r];if(u){var s;"_isNodeDef"in u?n=le({nodeProperties:(o=u).data,isRootLevel:!0}):(o=u.def,i=null==(s=u.target)?void 0:s.allowNullResult,u.map?(n=ce({mapFn:u.map,queryId:e.queryId,data:u.def.data,computed:u.def.computed,relational:u.def.relational,isRootLevel:!0}),a=function e(t){var r=se({mapFn:t.mapFn,properties:t.data,relational:t.relational}),n=Object.keys(r).reduce((function(n,o){if(t.data[o]||t.computed&&t.computed[o])return n;var a=function(r){var o={def:r.def,_relationshipName:r._relationshipName,properties:ce({queryId:t.queryId,mapFn:r.mapFn,data:r.def.data,computed:r.def.computed,relational:r.def.relational,isRootLevel:!0})},a=e({queryId:t.queryId,mapFn:r.mapFn,data:r.def.data,computed:r.def.computed,relational:r.def.relational});a&&(o.relational=a);var u=r._relational;if(u===exports.RELATIONAL_TYPES.oneToOne)o.oneToOne=!0;else{if(u!==exports.RELATIONAL_TYPES.oneToMany)throw Error('relationalType "'+u+'" is not valid.');o.oneToMany=!0,i.queryBuilderOpts&&i.queryBuilderOpts.filter&&(o.filter=i.queryBuilderOpts.filter),i.queryBuilderOpts&&i.queryBuilderOpts.pagination&&(o.pagination=i.queryBuilderOpts.pagination),i.queryBuilderOpts&&i.queryBuilderOpts.sort&&(o.sort=i.queryBuilderOpts.sort)}n[r.alias]=o},i=r[o];if("function"==typeof i)return n;if(null==i._relational)throw Error('getRelationalQueries - the key "'+o+'" is not a data property, not a computed property and does not contain a relational query.');if(i._relational!==exports.RELATIONAL_TYPES.oneToOne&&i._relational!==exports.RELATIONAL_TYPES.oneToMany)throw Error("The relational query type "+i._relational+" is not valid");if("map"in i.queryBuilderOpts&&"function"==typeof i.queryBuilderOpts.map)a({_relational:i._relational,_relationshipName:i._relationshipName,alias:o,def:i.def,mapFn:i.queryBuilderOpts.map});else{var u=i.queryBuilderOpts;Object.keys(u).forEach((function(e){a({_relational:i._relational,_relationshipName:i._relationshipName,alias:o+"__rU__"+e,def:i.def[e],mapFn:u[e].map})}))}return n}),{});if(0!==Object.keys(n).length)return n}({mapFn:u.map,queryId:e.queryId,data:o.data,computed:o.computed,relational:o.relational})):n=le({nodeProperties:o.data,isRootLevel:!0}));var c={def:o,properties:n,relational:a,allowNullResult:i};if("target"in u&&null!=u.target){if("ids"in u.target&&null!=u.target.ids){if(u.target.ids.some((function(e){return"string"!=typeof e})))throw Error("Invalid id in target.ids");c.ids=u.target.ids}if("id"in u.target){if("string"!=typeof u.target.id)throw Error("Invalid id in target.id");c.id=u.target.id}}"filter"in u&&null!=u.filter&&(c.filter=u.filter),"pagination"in u&&null!=u.pagination&&(c.pagination=u.pagination),"sort"in u&&null!=u.sort&&(c.sort=u.sort),t[r]=c}})),t}function pe(e){return new Array(e).fill(" ").join("")}function fe(e){var t=""+pe(2*e.nestLevel);return t+=e.queryRecordEntry.properties.join(",\n"+pe(2*e.nestLevel)),e.queryRecordEntry.relational&&(t+=(""!==t?",":"")+function(e){return Object.keys(e.relationalQueryRecord).reduce((function(t,r){var n=e.relationalQueryRecord[r];if(!n._relationshipName)throw Error("relationalQueryRecordEntry is invalid\n"+JSON.stringify(n,null,2));var o=""+n._relationshipName;return t+"\n"+pe(2*e.nestLevel)+r+": "+o+" {\n"+("oneToMany"in n?he({propertiesString:fe({queryRecordEntry:n,nestLevel:e.nestLevel+2}),nestLevel:e.nestLevel+1}):fe({queryRecordEntry:n,nestLevel:e.nestLevel+1}))+"\n"+pe(2*e.nestLevel)+"}"}),"")}({relationalQueryRecord:e.queryRecordEntry.relational,nestLevel:e.nestLevel})),t}function ye(e){var r,n=e.def.type;if("ids"in e&&null!=e.ids)r=n+"s(ids: ["+e.ids.map((function(e){return'"'+e+'"'})).join(",")+"])";else if("id"in e&&null!=e.id)r=n+'(id: "'+e.id+'")';else{var o=function(e){var r,n,o=[];return null!=e.filter&&o.push("filter: "+(r=z(e.filter),n=ie(Object.keys({}||r).filter((function(e){return void 0!==r[e]._eq})).reduce((function(e,n){return t.set(e,n,r[n]._eq),e}),{}),{omitObjectIdentifier:!0}),"{"+Object.entries(n).reduce((function(e,t,r,n){var o=t[1];return e+=t[0]+": "+(null==o?null:'"'+String(o)+'"'),r<n.length-1&&(e+=", "),e}),"")+"}")),o.join(", ")}(e);r=n+"s"+(""!==o?"("+o+")":"")}return r}function he(e){return pe(2*e.nestLevel)+"nodes {\n"+e.propertiesString+"\n"+pe(2*e.nestLevel)+"}"}function ge(e){var t=function(e){var t=de(e),r=JSON.stringify(function e(t){return Object.keys(t).reduce((function(r,n){r.push(t[n].filter),r.push(t[n].sort);var o=t[n].relational;return o&&r.push.apply(r,e(o)||[]),r}),[])}(t)),n=("query "+ve({queryId:e.queryId})+" {\n"+Object.keys(t).map((function(e){return function(e){var t=ye(e);return"  "+e.alias+": "+t+" {\n"+(null==e.id?he({propertiesString:fe({queryRecordEntry:e,nestLevel:3}),nestLevel:2}):fe({queryRecordEntry:e,nestLevel:2}))+"\n  }"}(p({alias:e},t[e]))})).join("\n    ")+"\n}").trim();return{subscriptionConfigs:Object.keys(t).reduce((function(r,n){var o=ve({queryId:e.queryId+"_"+n}),a=t[n],i=ye(a);function u(e){if(!e[n].node)throw new j({subscriptionMessage:e,description:'No "node" found in message'});return e[n].node}function s(e){if(!e[n].operation)throw new j({subscriptionMessage:e,description:'No "operation" found in message'});return e[n].operation}return[("\n    subscription "+o+" {\n      "+n+": "+i+" {\n        node {\n          "+fe({queryRecordEntry:a,nestLevel:5})+"\n        }\n        operation { action, path }\n      }\n    }\n        ").trim()].forEach((function(e){r.push({alias:n,gqlString:e,extractNodeFromSubscriptionMessage:u,extractOperationFromSubscriptionMessage:s})})),r}),[]),queryGQLString:n,queryParamsString:r,queryRecord:t}}(e),r=t.subscriptionConfigs,o=t.queryRecord,a=t.queryParamsString;return{queryGQL:n.gql(t.queryGQLString),subscriptionConfigs:r.map((function(e){return p({},e,{gql:n.gql(e.gqlString)})})),queryRecord:o,queryParamsString:a}}function ve(e){return e.queryId.replace(/-/g,"_")}var be=["to"],me=["from"];function _e(e){var t=e.skipBooleanStringWrapping,r=xe({obj:e.nodeData,IDataRecord:e.IDataRecord,generatingMockData:e.generatingMockData});return Object.entries(r).reduce((function(e,r,n){var o=r[0],a=r[1];return n>0&&(e+="\n"),"childNodes"===o||"additionalEdges"===o?e+(o+": [\n{\n")+a.join("\n}\n{\n")+"\n}\n]":e+(o+": ")+(null===a||("true"===a||"false"===a)&&t?a:'"'+a+'"')}),"")}function Ee(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n")}function Oe(e){if(e.hasOwnProperty("to")){var t=e.to;return p({},m(e,be),{targetId:t})}if(e.hasOwnProperty("from"))return p({},m(e,me),{sourceId:e.from});throw new Error("convertEdgeDirectionNames - received invalid data")}function xe(e){var t=e.IDataRecord,r=e.generatingMockData;return Object.entries(e.obj).reduce((function(e,n){var o=n[0],a=n[1],i="function"==typeof t[o]?t[o]._default:t[o];if("childNodes"===o){if(!Array.isArray(a))throw new Error('"childNodes" is supposed to be an array');return p({},e,{childNodes:a.map((function(e){return _e({nodeData:e,IDataRecord:t,generatingMockData:r})}))})}if("additionalEdges"===o){if(!Array.isArray(a))throw new Error('"additionalEdges" is supposed to be an array');return p({},e,{additionalEdges:a.map((function(e){return _e({nodeData:Oe(e),IDataRecord:t,generatingMockData:r,skipBooleanStringWrapping:!0})}))})}return p({},e,function e(t){var r,n,o,a,i,u,s,c=t.key,l=t.value,d=t.IDataRecordForKey,f=t.generatingMockData,y=t.omitObjectIdentifier;if(null===l)return(r={})[c]=null,r;if(Array.isArray(l))return(n={})[c]="__JSON__"+(f?JSON.stringify(l):Ee(JSON.stringify(l))),n;if("object"==typeof l)return d.type===exports.DATA_TYPES.record||d.type===exports.DATA_TYPES.maybeRecord?((o={})[c]="__JSON__"+(f?JSON.stringify(l):Ee(JSON.stringify(l))),o):function(t){var r=t.parentKey,n=t.omitObjectIdentifier;return Object.entries(t.obj).reduce((function(o,a){var i=a[0],u=a[1],s=r?r+"__dot__"+i:i;return"object"!=typeof u||null==u||Array.isArray(u)?o=p({},o,e(p({key:s,value:u},t))):(n||(o[s]="__object__"),o=p({},o,Object.entries(u).reduce((function(r,n){return p({},r,e(p({key:s+"__dot__"+n[0],value:n[1]},t)))}),{}))),o}),{})}({obj:(a={},a[c]=l,a),IDataRecordForKey:d,generatingMockData:f,omitObjectIdentifier:y});if("string"==typeof l)return(i={})[c]=Ee(l),i;if("boolean"==typeof l||"number"==typeof l)return"number"==typeof l&&isNaN(l)?((s={})[c]=null,s):((u={})[c]=String(l),u);throw Error("I don't yet know how to handle feData of type \""+typeof l+'"')}({key:o,value:a,IDataRecordForKey:i,generatingMockData:r}))}),{})}function De(e){var t=e.queryRecord,r=Object.keys(t.def.data).filter((function(e){return t.properties.includes(e)})).reduce((function(e,r){return e[r]=t.def.data[r],e}),{}),n=p({type:e.queryRecord.def.type,version:"1"},function e(t){return Object.entries(t).reduce((function(t,r){var n=r[1];return t[r[0]]=function t(r){switch(r.type){case exports.DATA_TYPES.string:return Z();case exports.DATA_TYPES.maybeString:return we([Z(),null]);case exports.DATA_TYPES.stringEnum:return we(r.acceptableValues);case exports.DATA_TYPES.maybeStringEnum:return we([we(r.acceptableValues),null]);case exports.DATA_TYPES.number:return te(1,100);case exports.DATA_TYPES.maybeNumber:return we([te(1,100),null]);case exports.DATA_TYPES.boolean:return ee();case exports.DATA_TYPES.maybeBoolean:return we([ee(),null]);case exports.DATA_TYPES.object:return e(r.boxedValue);case exports.DATA_TYPES.maybeObject:return we([e(r.boxedValue),null]);case exports.DATA_TYPES.array:return new Array(te(1,10)).fill("").map((function(e){return t("function"==typeof r.boxedValue?r.boxedValue._default:r.boxedValue)}));case exports.DATA_TYPES.maybeArray:return we([new Array(te(1,10)).fill("").map((function(e){return t("function"==typeof r.boxedValue?r.boxedValue._default:r.boxedValue)})),null]);case exports.DATA_TYPES.record:var n;return(n={})[Z()]=t("function"==typeof r.boxedValue?r.boxedValue._default:r.boxedValue),n;case exports.DATA_TYPES.maybeRecord:var o;return we([(o={},o[Z()]=t("function"==typeof r.boxedValue?r.boxedValue._default:r.boxedValue),o),null]);default:throw new k(r.type)}}("function"==typeof n?n._default:n),t}),{})}(r));return t.def.generateMockData&&function e(t){var r=[];Object.keys(t.object).forEach((function(n){var o=t.extension[n];if(void 0===o){if(!t.deleteKeysNotInExtension)return;null!=t.object[n]&&"object"==typeof t.object[n]?function e(t){Object.keys(t.object).forEach((function(r){"object"==typeof t.object[r]?e({object:t.object[r]}):delete t.object[r]}))}({object:t.object[n]}):delete t.object[n]}else r.push(n),null==o||"object"!=typeof o||Array.isArray(o)?t.object[n]=o:t.extendNestedObjects?(t.object[n]=t.object[n]||{},e({object:t.object[n]||{},extension:o,deleteKeysNotInExtension:t.deleteKeysNotInExtension,extendNestedObjects:!0})):t.object[n]=o})),Object.keys(t.extension).filter((function(e){return!r.includes(e)})).forEach((function(r){var n=t.extension[r];null==n||"object"!=typeof n||Array.isArray(n)?t.object[r]=n:t.extendNestedObjects?(t.object[r]=t.object[r]||{},e({object:t.object[r],extension:n,deleteKeysNotInExtension:t.deleteKeysNotInExtension,extendNestedObjects:!0})):t.object[r]=n}))}({object:n,extension:t.def.generateMockData(),extendNestedObjects:!0,deleteKeysNotInExtension:!1}),xe({obj:n,IDataRecord:r,generatingMockData:!0})}function Pe(e){return function e(t){var r=t.queryRecords,n={};return Object.keys(r).forEach((function(t){var o,a=r[t],i={};if(0!=!!a.id||"oneToOne"in a){var u=De({queryRecord:a});a.relational&&(i=e({queryRecords:a.relational})),o=p({},u,i)}else{for(var s=te(2,10),c=[],l=0;l<s;l++){var d=De({queryRecord:a});a.relational&&(i=e({queryRecords:a.relational})),c.push(p({},d,i))}o={nodes:c}}n[t]=o})),n}({queryRecords:de({queryDefinitions:e.queryDefinitions,queryId:e.queryId})})}function we(e){return e[Math.floor(Math.random()*e.length)]}function qe(e){var t=e.operator,r=e.itemValue,n=e.filterValue;switch(t){case"_contains":return-1!==String(r).toLowerCase().indexOf(String(n).toLowerCase());case"_ncontains":return-1===String(r).toLowerCase().indexOf(String(n).toLowerCase());case"_eq":return String(r).toLowerCase()===String(n).toLowerCase();case"_neq":return String(r).toLowerCase()!==String(n).toLowerCase();case"_gt":return r>n;case"_gte":return r>=n;case"_lt":return r<n;case"_lte":return r<=n;default:throw new I({operator:t})}}function Se(e){var t=e.item,r=e.underscoreSeparatedPropName;return"__NULL__"===t[r]?null:t[r]}function Ne(e){var t=e.operator,r=e.filterValue,n=e.underscoreSeparatedPropName;return e.relationalItems.some((function(e){var o=Se({item:e,underscoreSeparatedPropName:n});return qe({operator:t,filterValue:r,itemValue:o})}))}function Re(e,t){return null===e[t]||"__NULL__"===e[t]?null:Number(e[t])||e[t]}function Te(e,r){Object.keys(e).forEach((function(n){var o=e[n],a=t.isArray(r[n].nodes);o.filter&&function(e){var r=e.queryRecordEntry,n=e.data,o=e.alias,a=z(e.filter);if(a&&n[o]){var i=Object.keys(a).map((function(e){var t=String(e).split("."),n=t[0],o=t.slice(1),i=n&&r.relational&&r.relational[n],u=a[e],s=Object.keys(u).filter((function(e){return"_condition"!==e})).map((function(e){return{operator:e,value:u[e]}})),c=!!i,l=c?o.join("__dot__"):e.replaceAll(".","__dot__");return{dotSeparatedPropName:e,underscoreSeparatedPropName:l,propNotInQuery:c?!1===i.properties.includes(l):!1===r.properties.includes(l),operators:s,condition:u._condition,isRelational:c,relationalKey:n,oneToOne:i&&"oneToOne"in i||void 0,oneToMany:i&&"oneToMany"in i||void 0}}));i.length>0&&t.update(n,o+".nodes",(function(e){return t.isArray(e)?e.filter((function(e){var t=i.find((function(e){return e.propNotInQuery}));if(t)throw new P({filterPropName:t.dotSeparatedPropName});var r=i.filter((function(e){return"OR"===e.condition})),n=i.filter((function(e){return"AND"===e.condition})),o=n.every((function(t){if(t.isRelational)return t.operators.every((function(r){var n=r.operator,o=r.value;return!0===t.oneToOne?qe({operator:n,filterValue:o,itemValue:t.relationalKey?Se({item:e[t.relationalKey],underscoreSeparatedPropName:t.underscoreSeparatedPropName}):""}):Ne({relationalItems:t.relationalKey&&e[t.relationalKey].nodes||[],operator:n,filterValue:o,underscoreSeparatedPropName:t.underscoreSeparatedPropName})}));var r="__NULL__"===e[t.underscoreSeparatedPropName]?null:e[t.underscoreSeparatedPropName];return t.operators.every((function(e){return qe({operator:e.operator,filterValue:e.value,itemValue:r})}))}))||0===n.length;if(!o)return!1;var a=r.some((function(t){if(t.isRelational)return t.operators.some((function(r){var n=r.operator,o=r.value;return!0===t.oneToOne?qe({operator:n,filterValue:o,itemValue:t.relationalKey?Se({item:e[t.relationalKey],underscoreSeparatedPropName:t.underscoreSeparatedPropName}):""}):Ne({relationalItems:t.relationalKey&&e[t.relationalKey].nodes||[],operator:n,filterValue:o,underscoreSeparatedPropName:t.underscoreSeparatedPropName})}));var r=t.relationalKey?Se({item:e,underscoreSeparatedPropName:t.underscoreSeparatedPropName}):"";return t.operators.some((function(e){return qe({operator:e.operator,filterValue:e.value,itemValue:r})}))}))||0===r.length;return o&&a})):e}))}}({queryRecordEntry:o,filter:o.filter,data:r,alias:n}),o.sort&&function(e){var r=e.queryRecordEntry,n=e.data,o=e.alias,a=function e(r){var n={};for(var o in r){var a=r[o],i=t.isObject(a)&&!Object.keys(a).includes("_direction");if("object"==typeof r[o]&&null!==r[o]&&i){var u=e(a);for(var s in u)u.hasOwnProperty(s)&&(n[o+"."+s]=u[s])}else t.isObject(a)?n[o]=a:void 0!==a&&(n[o]={_direction:a})}return n}(e.sort);if(a&&n[o]){var i=t.orderBy(Object.keys(a).map((function(e,t){var r=e.replaceAll(".","__dot__");return{direction:a[e]._direction||"asc",underscoreSeparatedPropertyPath:r,propertyPath:e,priority:a[e]._priority||1e4*(t+1)}})),(function(e){return e.priority}),"asc"),u=i.filter((function(e){return!1===r.properties.includes(e.underscoreSeparatedPropertyPath)}));if(u.length>0)throw new w({sortPropName:u[0].propertyPath});t.update(n,o+".nodes",(function(e){return t.isArray(e)?e.sort((function(e,t){return i.map((function(r){return function(e,t,r){return e===t?0:null===e?1:null===t?-1:r?e<t?-1:1:e<t?1:-1}(Re(e,r.underscoreSeparatedPropertyPath),Re(t,r.underscoreSeparatedPropertyPath),"asc"===r.direction)})).reduce((function(e,t){return e||t}),void 0)})):e}))}}({queryRecordEntry:o,sort:o.sort,data:r,alias:n});var i=o.relational;null!=i&&(a?r[n]&&r[n].nodes&&r[n].nodes.forEach((function(e){Te(i,e)})):Te(i,r[n]))}))}var Ae=0;function je(e){return Object.entries(e).reduce((function(e,t){var r=t[0],n=t[1],o=n&&"tokenName"in n&&null!=n.tokenName?n.tokenName:"default";return e[o]=e[o]||{},e[o][r]=n,e}),{})}function Ie(e){return Object.entries(e).reduce((function(e,t){var r=t[1];return r?(e[t[0]]=r,e):e}),{})}function ke(e){return Object.entries(e).reduce((function(e,t){return null==t[1]&&(e[t[0]]=null),e}),{})}function Ce(e){var t=e.mmGQLInstance,r=e.queryManager;return function(){var e=d(X.mark((function e(n,o){var a,i,u,s,c,l,f,y,h,g,v,b,m,_;return X.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h=function(){return(h=d(X.mark((function e(){return X.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Object.entries(f).map(function(){var e=d(X.mark((function e(r){var n,a,u,c,l,d,p,f;return X.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=ge({queryDefinitions:a=r[1],queryId:i+"_"+(n=r[0])}),l=c.queryGQL,d=c.queryRecord,!t.generateMockData){e.next=6;break}u=Pe({queryDefinitions:a,queryId:i}),e.next=11;break;case 6:return p={gql:l,token:s(n)},o&&"batchKey"in o&&(p.batchKey=o.batchKey),e.next=10,t.gqlClient.query(p);case 10:u=e.sent;case 11:return Te(d,f=u),e.abrupt("return",f);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return e.abrupt("return",e.sent.reduce((function(e,t){return p({},e,t)}),p({},l)));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)},y=function(){return h.apply(this,arguments)},s=function(e){var r=t.getToken({tokenName:e});if(!r)throw new Error('No token registered with the name "'+e+'".\nPlease register this token prior to using it with setToken({ tokenName, token })) ');return r},u=function(e,t){return e.stack="\n"+(t||e.stack)+"\n"+a.substring(a.indexOf("\n")+1),e},a=(new Error).stack,i=(null==o?void 0:o.queryId)||"query"+Ae++,c=Ie(n),l=ke(n),f=je(c),e.prev=9,Object.keys(c).length){e.next=13;break}return(null==o?void 0:o.onData)&&o.onData({results:p({},l)}),e.abrupt("return",{data:p({},l),error:void 0});case 13:return e.next=15,y();case 15:g=e.sent,v=r||new t.QueryManager(ge({queryDefinitions:c,queryId:i}).queryRecord),e.prev=17,v.onQueryResult({queryId:i,queryResult:g}),e.next=30;break;case 21:if(e.prev=21,e.t0=e.catch(17),b=u(new Error("Error applying query results"),e.t0.stack),null==o||!o.onError){e.next=29;break}return o.onError(b),e.abrupt("return",{data:{},error:b});case 29:throw b;case 30:return m=v.getResults(),(null==o?void 0:o.onData)&&o.onData({results:p({},l,m)}),e.abrupt("return",{data:p({},l,m),error:void 0});case 35:if(e.prev=35,e.t1=e.catch(9),_=u(new Error("Error querying data"),e.t1.stack),null==o||!o.onError){e.next=43;break}return o.onError(_),e.abrupt("return",{data:{},error:_});case 43:throw _;case 44:case"end":return e.stop()}}),e,null,[[9,35],[17,21]])})));return function(t,r){return e.apply(this,arguments)}}()}var Le,Fe,Me,Ue,Ve,Qe=0,Be=function(){function e(e){this.itemsPerPage=void 0,this.page=void 0,this.onPaginate=void 0,this.items=void 0,this.itemsPerPage=e.itemsPerPage,this.page=e.page,this.items=e.items,this.onPaginate=e.onPaginate}var t,r=e.prototype;return r.goToPage=function(e){if(e<1||e>this.totalPages)throw new N({page:e});this.page=e,this.onPaginate&&this.onPaginate({page:e,itemsPerPage:this.itemsPerPage})},r.goToNextPage=function(){this.hasNextPage&&this.goToPage(this.page+1)},r.goToPreviousPage=function(){this.hasPreviousPage&&this.goToPage(this.page-1)},(t=[{key:"nodes",get:function(){return t=1===(e={items:this.items,page:this.page,itemsPerPage:this.itemsPerPage}).page?0:(e.page-1)*e.itemsPerPage,Array.from(e.items||[]).slice(t,t+e.itemsPerPage);var e,t}},{key:"totalPages",get:function(){return Math.ceil((this.items||[]).length/this.itemsPerPage)}},{key:"hasNextPage",get:function(){return this.totalPages>this.page}},{key:"hasPreviousPage",get:function(){return this.page>1}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}();function Ye(e,t){var r=e.filter((function(e){return"name"in e&&!!e.name})).map((function(e){if("name"in e)return e.name;throw Error("Expected an operation name here")}));return r.length?r.join("__"):t}function Ke(e){return"\n    view: "+(e.view?"true":"false")+",\n    edit: "+(e.edit?"true":"false")+",\n    manage: "+(e.manage?"true":"false")+",\n    terminate: "+(e.terminate?"true":"false")+",\n    addChild: "+(e.addChild?"true":"false")+"\n  "}function Ge(e){var t='{\ntype: "'+(e.type||"access")+'",'+Ke(e.permissions)+"}",r=Ye([e],"CreateEdge");return n.gql(Le||(Le=_(["\n    mutation ",' {\n        AttachEdge(\n            newSourceId: "','"\n            targetId: "','"\n            edge: ',"\n            transactional: true\n        )\n    }"])),r,e.from,e.to,t)}function Je(e){var t=Ye([e],"DropEdge");return n.gql(Fe||(Fe=_(["\n    mutation ",' {\n        DropEdge(\n            sourceId: "','"\n            targetId: "','"\n            edgeType: "','"\n            transactional: true\n        )\n    }'])),t,e.from,e.to,e.type||"access")}function ze(e){var t=Ye([e],"ReplaceEdge"),r='{\ntype: "'+(e.type||"access")+'", '+Ke(e.permissions)+"}";return n.gql(Me||(Me=_(["\n    mutation ",' {\n        ReplaceEdge(\n            currentSourceId: "','"\n            newSourceId: "','"\n            targetId: "','"\n            edge: ',"\n            transactional: true\n        )\n    }"])),t,e.current,e.from,e.to,r)}function We(e){var t='{\ntype: "'+(e.type||"access")+'", '+Ke(e.permissions)+"}",r=Ye([e],"UpdateEdge");return n.gql(Ue||(Ue=_(["\n    mutation ",' {\n        UpdateEdge(\n            sourceId: "','"\n            targetId: "','"\n            edge: ',"\n            transactional: true\n        )\n    }"])),r,e.from,e.to,t)}function He(e){var t=["node: {\n        "+oe(e.data)+"\n      }"];if(e.under){var r="string"==typeof e.under?'["'+e.under+'"]':'["'+e.under.join('", "')+'"]';t.push("underIds: "+r)}return"{\n    "+t.join("\n")+"\n  }"}var Xe,$e,Ze,et=o.createContext(void 0),tt=o.createContext({unsafe__silenceDuplicateSubIdErrors:!1}),rt={suspendEnabled:"suspendEnabled",suspendDisabled:"suspendDisabled"};function nt(e){var t=new a.WebSocketLink({uri:e.wsUrl,options:{reconnect:!0}}),r=new i.HttpLink({uri:e.httpUrl}),o=n.split((function(e){return e.getContext().batchKey}),new u.BatchHttpLink({uri:e.httpUrl,batchMax:50,batchInterval:50,batchKey:function(e){var t=e.getContext();return JSON.stringify({batchKey:t.batchKey,headers:t.headers,credentials:t.credentials})}}),r),c=n.split((function(e){return e.getContext().batchedMutation}),new u.BatchHttpLink({uri:e.httpUrl,batchMax:Number.MAX_SAFE_INTEGER,batchInterval:0}),o),l=n.split((function(e){var t=s.getMainDefinition(e.query);return"OperationDefinition"===t.kind&&"subscription"===t.operation}),t,c);function f(e){return{headers:{Authorization:"Bearer "+e.token}}}function y(e){var t,r=null==(t=e.gql.loc)?void 0:t.source.body;if(!r)throw new Error("No documentBody found");var o=["GetChildren","GetReferences","GetNodes","GetNodesNew","GetNodesById"];if(o.some((function(e){return null==r?void 0:r.includes(e+"(")}))){var a=r;return o.forEach((function(t){a=a.replace(new RegExp(t+"\\((.*)\\)","g"),t+'($1, authToken: "'+e.token+'")')})),n.gql(a)}return e.gql}var h,g,v=new n.ApolloLink((function(e,t){return new n.Observable((function(r){var n;return Promise.resolve(e).then((function(){n=t(e).subscribe({next:r.next.bind(r),error:r.error.bind(r),complete:r.complete.bind(r)})})).catch(r.error.bind(r)),function(){n&&n.unsubscribe()}}))})),b=new n.ApolloClient({link:n.ApolloLink.from([v,l]),cache:new n.InMemoryCache,defaultOptions:{watchQuery:{fetchPolicy:"no-cache",errorPolicy:"ignore"},query:{fetchPolicy:"no-cache",errorPolicy:"all"}}});return{query:(g=d(X.mark((function e(t){return X.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.query({query:t.gql,context:p({batchKey:"batchKey"in t?t.batchKey:"default"},f({token:t.token}))});case 2:return e.abrupt("return",e.sent.data);case 6:case"end":return e.stop()}}),e)}))),function(e){return g.apply(this,arguments)}),subscribe:function(e){var t=b.subscribe({query:y(e)}).subscribe({next:function(t){t.data?e.onMessage(t.data):e.onError(new Error("Unexpected message structure.\n"+t))},error:e.onError});return function(){return t.unsubscribe()}},mutate:(h=d(X.mark((function e(t){return X.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Promise.all(t.mutations.map((function(e){return b.mutate({mutation:e,context:p({batchedMutation:!0},f({token:t.token}))})})));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),function(e){return h.apply(this,arguments)})}}function ot(e){return"{\n      "+oe(e)+"\n    }"}require("isomorphic-fetch");var at=function(){function e(e){var r;this.gqlClient=void 0,this.generateMockData=void 0,this.plugins=void 0,this.query=void 0,this.subscribe=void 0,this.QueryManager=void 0,this.transaction=void 0,this.tokens={},this.DOFactory=void 0,this.DOProxyGenerator=void 0,this.optimisticUpdatesOrchestrator=void 0,this.gqlClient=e.gqlClient,this.generateMockData=e.generateMockData,this.plugins=e.plugins,this.query=Ce({mmGQLInstance:this}),this.subscribe=(r=this,function(){var e=d(X.mark((function e(t,n){var o,a,i,u,s,c,l,d,f,y,h,g,v,b,m,_,E,O,x,D,P,w;return X.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E=function(){v.forEach((function(e){return e()}))},_=function(){var e=je(i);Object.entries(e).forEach((function(e){var t=e[0],o=ge({queryDefinitions:e[1],queryId:a+"_"+t});v.push.apply(v,o.subscriptionConfigs.map((function(e){return r.gqlClient.subscribe({gql:e.gql,token:g(t),onMessage:function(t){b?m.push({message:t,subscriptionConfig:e}):(h({message:t,subscriptionConfig:e}),n.onData({results:p({},u,y.getResults())}))},onError:function(e){var t=f(new Error("Error in a subscription message"),e.stack);n.onError?n.onError(t):console.error(t)}})})))}))},g=function(e){var t=r.getToken({tokenName:e});if(!t)throw new Error('No token registered with the name "'+e+'".\nPlease register this token prior to using it with setToken({ tokenName, token })) ');return t},h=function(e){var t,r;try{t=e.subscriptionConfig.extractNodeFromSubscriptionMessage(e.message),r=e.subscriptionConfig.extractOperationFromSubscriptionMessage(e.message),y.onSubscriptionMessage({node:t,operation:r,queryId:a,subscriptionAlias:e.subscriptionConfig.alias})}catch(e){var o=f(new Error("Error applying subscription message"),e.stack);n.onError?n.onError(o):console.error(o)}},f=function(e,t){return e.stack="\n"+(t||e.stack)+"\n"+o.substring(o.indexOf("\n")+1),e},o=(new Error).stack,a=(null==n?void 0:n.queryId)||"query"+Qe++,i=Ie(t),u=ke(t),Object.keys(i).length){e.next=12;break}return n.onData({results:p({},u)}),e.abrupt("return",{data:p({},u),unsub:function(){}});case 12:s=ge({queryDefinitions:i,queryId:a}),c=s.queryGQL,l=s.queryRecord,d=s.queryParamsString,n.onQueryInfoConstructed&&n.onQueryInfoConstructed({queryGQL:c,queryId:a,queryParamsString:d}),y=new r.QueryManager(l,{onPaginate:n.onPaginate}),v=[],b=!n.skipInitialQuery,m=[],e.prev=18,r.generateMockData||_(),n.onSubscriptionInitialized&&n.onSubscriptionInitialized(E),e.next=32;break;case 23:if(e.prev=23,e.t0=e.catch(18),O=f(new Error("Error initializating subscriptions"),e.t0.stack),null==n||!n.onError){e.next=31;break}return n.onError(O),e.abrupt("return",{data:{},unsub:E,error:O});case 31:throw O;case 32:if(!n.skipInitialQuery){e.next=36;break}return e.abrupt("return",{unsub:E});case 36:return x=Ce({mmGQLInstance:r,queryManager:y}),e.prev=37,D={queryId:n.queryId},n&&"batchKey"in n&&(D.batchKey=n.batchKey),e.next=42,x(t,D);case 42:e.next=53;break;case 44:if(e.prev=44,e.t1=e.catch(37),P=f(new Error("Error querying initial data set"),e.t1.stack),null==n||!n.onError){e.next=52;break}return n.onError(P),e.abrupt("return",{data:{},unsub:E,error:P});case 52:throw P;case 53:return b&&(b=!1,m.forEach(h),m.length=0),w=y.getResults(),n.onData({results:p({},u,w)}),e.abrupt("return",{data:p({},u,w),unsub:E,error:null});case 57:case"end":return e.stop()}}),e,null,[[18,23],[37,44]])})));return function(t,r){return e.apply(this,arguments)}}()),this.DOProxyGenerator=function(e){return function(t){var r=t.relationalResults,n=t.node.computed,o=n?Object.keys(n).reduce((function(t,r){var o,i=function(){return n[r](a)};return null==(o=e.plugins)||o.forEach((function(e){var t;null!=(t=e.DOProxy)&&t.computedDecorator&&(i=e.DOProxy.computedDecorator({ProxyInstance:a,computedFn:i}))})),t[r]=i,t}),{}):{},a=new Proxy(t.do,{getOwnPropertyDescriptor:function(e,r){if(t.allPropertiesQueried.includes(r)||t.relationalQueries&&Object.keys(t.relationalQueries).includes(r)||Object.keys(B).includes(r))return p({},Object.getOwnPropertyDescriptor(e,r),{enumerable:!0});if(n&&Object.keys(n).includes(r))try{return o[r](),p({},Object.getOwnPropertyDescriptor(e,r),{enumerable:!0})}catch(t){if(!(t instanceof x))throw t;return p({},Object.getOwnPropertyDescriptor(e,r),{enumerable:!1})}return p({},Object.getOwnPropertyDescriptor(e,r),{enumerable:!1})},get:function(e,n){if("updateRelationalResults"===n)return function(e){r=p({},r,e)};if(r&&t.relationalQueries&&Object.keys(r).includes(n))return r[n];if(Object.keys(t.node.data).includes(n)){if(!t.allPropertiesQueried.includes(n))throw new x({propName:n,queryId:t.queryId,nodeType:t.node.type});var a=t.node.data[n];return a.type===exports.DATA_TYPES.object||a.type===exports.DATA_TYPES.maybeObject?null==t.do[n]?t.do[n]:function e(t){var r={};return Object.keys(t.dataForThisObject).forEach((function(n){var o=t.parentObjectKey?t.parentObjectKey+"__dot__"+n:n,a=t.dataForThisObject[n],i=t.allPropertiesQueried.includes(o)||t.allPropertiesQueried.some((function(e){return e.startsWith(o)}));Object.defineProperty(r,n,{enumerable:i,get:function(){if(a.type===exports.DATA_TYPES.object||a.type===exports.DATA_TYPES.maybeObject)return null==t.allCachedData[n]?t.allCachedData[n]:e({nodeType:t.nodeType,queryId:t.queryId,allCachedData:t.allCachedData[n],dataForThisObject:a.boxedValue,allPropertiesQueried:t.allPropertiesQueried,parentObjectKey:o});if(!i)throw new x({propName:o,nodeType:t.nodeType,queryId:t.queryId});return t.allCachedData?t.allCachedData[n]:void 0}})})),r}({nodeType:t.node.type,queryId:t.queryId,allCachedData:t.do[n],dataForThisObject:a.boxedValue,allPropertiesQueried:t.allPropertiesQueried,parentObjectKey:n}):t.do[n]}if(o[n])try{return o[n]()}catch(e){if(e instanceof x)throw new D({computedPropName:n,propName:e.propName,nodeType:t.node.type,queryId:t.queryId});throw e}return e[n]}});return a}}(this),this.DOFactory=function(e){return function(t){return function(){function r(r){var n,o=this;this.parsedData=void 0,this.version=-1,this.id=void 0,this.lastUpdatedBy=void 0,this.persistedData={},this._defaults=void 0,this.type=t.type,this.getDefaultData=function(e){if(e instanceof C)return o.isObjectType(e.type)?o.getDefaultData(e.boxedValue):e.defaultValue;var t=function(t,r){var n=r||e[t]._default;if(n instanceof Error)throw n;return o.isArrayType(n.type)?o.isObjectType(n.boxedValue.type)?[o.getDefaultData(n.boxedValue.boxedValue)]:[n.boxedValue.defaultValue]:n.defaultValue};return"function"==typeof e?t(void 0,e._default):Object.keys(e).reduce((function(r,n){var a=e[n];if(o.isObjectType(a.type)||o.isRecordType(a.type))r[n]=o.getDefaultData(a.boxedValue);else if("function"==typeof a){var i=t(n);r[n]=i}else r[n]=e[n].defaultValue;return r}),{})},this.onDataReceived=function(e,r){if(null==e.version)throw Error("Message received for a node was missing a version");var n=Number(e.version);if(null!=r&&r.__unsafeIgnoreVersion||n>=o.version){o.version=n,o.lastUpdatedBy=e.lastUpdatedBy;var a=o.parseReceivedData({initialData:e,nodeProperties:t.properties});o.extendPersistedWithNewlyReceivedData({data:t.properties,object:o.persistedData,extension:a}),o.parsedData=o.getParsedData({data:t.properties,persistedData:o.persistedData,defaultData:o._defaults})}},this.setObjectProp=function(e){Object.defineProperty(o,e,{configurable:!0,enumerable:!0,get:function(){return o.parsedData[e]}})},this.setPrimitiveValueProp=function(e){Object.defineProperty(o,e,{configurable:!0,enumerable:!0,get:function(){return o.parsedData[e]}})},this.setArrayProp=function(e){Object.defineProperty(o,e,{configurable:!0,enumerable:!0,get:function(){return o.parsedData[e]}})},this._defaults=this.getDefaultData(t.properties),this.id=r.id,this.lastUpdatedBy=r.lastUpdatedBy,null!=r.version&&(this.version=Number(r.version)),r&&(this.persistedData=this.parseReceivedData({initialData:r,nodeProperties:t.properties})),this.parsedData=this.getParsedData({data:t.properties,persistedData:this.persistedData,defaultData:this._defaults}),null==(n=e.plugins)||n.forEach((function(e){var t;null!=(t=e.DO)&&t.onConstruct&&e.DO.onConstruct({DOInstance:o,parsedDataKey:"parsedData"})})),this.initializeNodePropGetters(),this.initializeNodeComputedGetters(),this.initializeNodeRelationalGetters()}var n=r.prototype;return n.parseReceivedData=function(e){var t=this,r=e.initialData;return Object.entries(e.nodeProperties).reduce((function(e,n){var o=n[0],a=t.getData(n[1]),i=o in r&&null!=r[o]&&"__NULL__"!==r[o];return t.isObjectType(a.type)&&i?e[o]=t.parseReceivedData({initialData:r[o],nodeProperties:a.boxedValue}):t.isArrayType(a.type)&&i?e[o]=r[o].map(a.boxedValue.parser):o in r&&null===r[o]?e[o]=null:i&&(e[o]=a.parser(r[o])),e}),{})},n.getParsedData=function(e){var t=this;if(e.data instanceof C&&e.data.isOptional&&null==e.persistedData)return null;var r=this.getData(e.data);return r instanceof C&&r.boxedValue?this.isArrayType(r.type)?e.persistedData?(e.persistedData||[]).map((function(n){var o;return t.getParsedData({data:r.boxedValue,persistedData:n,defaultData:r.type===exports.DATA_TYPES.array&&(null==(o=e.defaultData)?void 0:o[0])||null})})):e.defaultData:(e.persistedData||(e.persistedData={}),this.getData(r.boxedValue)instanceof C?Object.keys(e.persistedData).reduce((function(n,o){return n[o]=t.getParsedData({data:r.boxedValue,persistedData:e.persistedData[o],defaultData:e.defaultData}),n}),{}):Object.keys(r.boxedValue).reduce((function(n,o){var a;return n[o]=t.getParsedData({data:r.boxedValue[o],persistedData:e.persistedData[o],defaultData:null==(a=e.defaultData)?void 0:a[o]}),n}),{})):r instanceof C?"__NULL__"===e.persistedData&&e.data.isOptional?null:null!=e.persistedData?r.parser(e.persistedData):e.defaultData:Object.keys(r).reduce((function(n,o){return n[o]=t.getParsedData({data:r[o],persistedData:e.persistedData[o],defaultData:e.defaultData[o]}),n}),{})},n.extendPersistedWithNewlyReceivedData=function(e){var t=this;Object.entries(e.extension).forEach((function(r){var n=r[0],o=r[1],a=t.getData(e.data[n]);t.isRecordType(a.type)?e.object[n]=o:t.isObjectType(a.type)?null==o?e.object[n]=null:(e.object[n]=e.object[n]||{},t.extendPersistedWithNewlyReceivedData({data:a.boxedValue,object:e.object[n],extension:o})):e.object[n]=o}))},n.initializeNodePropGetters=function(){var e=this;Object.keys(t.properties).forEach((function(r){if(!Object.keys(B).includes(r)){var n=e.getData(t.properties[r]);e.isObjectType(n.type)?e.setObjectProp(r):e.isArrayType(n.type)?e.setArrayProp(r):e.setPrimitiveValueProp(r)}}))},n.initializeNodeComputedGetters=function(){var e=this,r=t.computed;r&&Object.keys(r).forEach((function(t){e.setComputedProp({propName:t,computedFn:r[t]})}))},n.initializeNodeRelationalGetters=function(){var e=this,r=t.relational;r&&Object.keys(r).forEach((function(t){e.setRelationalProp({relationshipName:t,relationalQueryGetter:r[t]})}))},n.setComputedProp=function(t){var r,n=this,o=function(){return t.computedFn(n)};null==(r=e.plugins)||r.forEach((function(e){var t;null!=(t=e.DO)&&t.computedDecorator&&(o=e.DO.computedDecorator({computedFn:o,DOInstance:n}))})),Object.defineProperty(this,t.propName,{get:function(){return o()},configurable:!0,enumerable:!0})},n.setRelationalProp=function(e){Object.defineProperty(this,e.relationshipName,{configurable:!0,get:function(){return e.relationalQueryGetter()}})},n.getData=function(e){return"function"==typeof e?e._default:e},n.isArrayType=function(e){return e===exports.DATA_TYPES.array||e===exports.DATA_TYPES.maybeArray},n.isObjectType=function(e){return e===exports.DATA_TYPES.object||e===exports.DATA_TYPES.maybeObject},n.isRecordType=function(e){return e===exports.DATA_TYPES.record||e===exports.DATA_TYPES.maybeRecord},r}()}}(this),this.QueryManager=function(e){return function(){function t(e,t){this.state={},this.queryRecord=void 0,this.opts=void 0,this.queryRecord=e,this.opts=t}var r=t.prototype;return r.onQueryResult=function(e){this.notifyRepositories({data:e.queryResult,queryRecord:this.queryRecord}),this.state=this.getNewStateFromQueryResult(p({},e,{queryRecord:this.queryRecord}))},r.onSubscriptionMessage=function(e){var t,r,n=e.subscriptionAlias,o=this.queryRecord[n];this.notifyRepositories({data:(t={},t[n]=e.node,t),queryRecord:(r={},r[n]=o,r)}),this.updateProxiesAndStateFromSubscriptionMessage(e)},r.getResults=function(){return this.getResultsFromState(this.state)},r.getResultsFromState=function(e){var t=this;return Object.keys(e).reduce((function(r,n){var o=e[n],a=o.idsOrIdInCurrentResult,i=t.removeUnionSuffix(n);if(Array.isArray(a)){var u,s,c,l=a.map((function(e){return o.proxyCache[e].proxy}));r[i]=new Be({items:l,itemsPerPage:(null==(u=o.pagination)?void 0:u.itemsPerPage)||l.length,page:(null==(s=o.pagination)?void 0:s.page)||1,onPaginate:null==(c=t.opts)?void 0:c.onPaginate})}else r[i]=a?o.proxyCache[a].proxy:null;return r}),{})},r.notifyRepositories=function(e){var t=this;Object.keys(e.queryRecord).forEach((function(r){var n=t.getDataFromResponse({queryRecord:e.queryRecord[r],dataForThisAlias:e.data[r]});if(!n)throw Error('notifyRepositories could not find resulting data for the alias "'+r+'" in the following queryRecord:\n'+JSON.stringify(e.queryRecord,null,2)+"\nResulting data:\n"+JSON.stringify(e.data,null,2));var o=e.queryRecord[r].def.repository;Array.isArray(n)?n.forEach((function(e){return o.onDataReceived(e)})):o.onDataReceived(n);var a=e.queryRecord[r].relational;a&&Object.keys(a).forEach((function(e){var r=Array.isArray(n)?n.flatMap((function(t){return t[e]})):n[e];Array.isArray(r)||(r=[r]),r.forEach((function(r){var n,o,i=a[e];e.includes("__rU__")&&r&&r.type!==i.def.type||t.notifyRepositories({data:(n={},n[e]=r,n),queryRecord:(o={},o[e]=i,o)})}))}))}))},r.getNewStateFromQueryResult=function(e){var t=this;return Object.keys(e.queryRecord).reduce((function(r,n){var o=t.buildCacheEntry({nodeData:t.getDataFromResponse({dataForThisAlias:e.queryResult[n],queryRecord:e.queryRecord[n]}),queryId:e.queryId,queryAlias:n});return o?(r[n]=o,r):r}),{})},r.buildCacheEntry=function(t){var r=this,n=t.nodeData,o=t.queryAlias,a=t.queryRecord||this.queryRecord,i=a[t.queryAlias].relational;if(o.includes("__rU__")){var u=t.nodeData[0];if(u&&u.type!==a[t.queryAlias].def.type)return null}var s,c=function(n){var u=function(e){return i?Object.keys(i).reduce((function(n,o){var a,u=r.getDataFromResponse({queryRecord:i[o],dataForThisAlias:e[o]});if(!u)return n;var s=r.buildCacheEntry({nodeData:u,queryId:t.queryId,queryAlias:o,queryRecord:i});return s?p({},n,((a={})[r.removeUnionSuffix(o)]=s,a)):n}),{}):null}(n),s=a[o].def.repository,c=i?r.getApplicableRelationalQueries({relationalQueries:i,nodeData:n}):null;return{proxy:e.DOProxyGenerator({node:a[t.queryAlias].def,allPropertiesQueried:a[t.queryAlias].properties,relationalQueries:c,queryId:t.queryId,relationalResults:u?r.getResultsFromState(u):null,do:s.byId(n.id)}),relationalState:u}};if(Array.isArray(t.nodeData)){if("id"in a[t.queryAlias]){if(null==t.nodeData[0]){if(!a[t.queryAlias].allowNullResult)throw new A({receivedData:t.nodeData,message:'Queried a node by id for the query with the id "'+t.queryId+'" but received back an empty array'});return{idsOrIdInCurrentResult:null,proxyCache:{}}}return{idsOrIdInCurrentResult:t.nodeData[0].id,proxyCache:t.nodeData.reduce((function(e,t){return e[t.id]=c(t),e}),{})}}return{idsOrIdInCurrentResult:t.nodeData.map((function(e){return e.id})),proxyCache:t.nodeData.reduce((function(e,t){return e[t.id]=c(t),e}),{}),pagination:a[t.queryAlias].pagination}}return{idsOrIdInCurrentResult:t.nodeData.id,proxyCache:(s={},s[n.id]=c(n),s)}},r.updateProxiesAndStateFromSubscriptionMessage=function(e){var t=e.node,r=e.queryId,n=e.subscriptionAlias,o=e.operation;if("DeleteNode"!==o.action&&"DeleteEdge"!==o.action||o.path!==t.id){var a=this.queryRecord[n];this.state[n]=this.state[n]||{};var i=this.state[n],u=t.id,s=i.proxyCache[u]||{},c=s.proxy,l=s.relationalState;if(c){var d=this.recursivelyUpdateProxyAndReturnNewCacheEntry({queryId:r,proxy:c,newRelationalData:this.getRelationalData({queryRecord:a,node:e.node}),relationalQueryRecord:a.relational||null,currentState:{proxy:c,relationalState:l}});i.proxyCache[u]=d}else{var p=this.buildCacheEntry({nodeData:t,queryId:r,queryAlias:n,queryRecord:this.queryRecord});if(!p)return;var f=p.proxyCache;if(!f[t.id])throw Error("Expected a newly generated proxy");i.proxyCache[u]=f[t.id]}if("id"in a){if(i.idsOrIdInCurrentResult===u)return;this.state[e.subscriptionAlias].idsOrIdInCurrentResult=u}else{if((i.idsOrIdInCurrentResult||[]).includes(u))return;this.state[e.subscriptionAlias].idsOrIdInCurrentResult=[u].concat(this.state[e.subscriptionAlias].idsOrIdInCurrentResult)}}else{var y=this.state[n].idsOrIdInCurrentResult;this.state[n].idsOrIdInCurrentResult=Array.isArray(y)?y.filter((function(e){return e!==t.id})):null}},r.recursivelyUpdateProxyAndReturnNewCacheEntry=function(e){var t=this,r=e.queryId,n=e.proxy,o=e.newRelationalData,a=e.relationalQueryRecord,i=e.currentState.relationalState,u=a?Object.keys(a).reduce((function(e,n){if(!o||!o[n])return e;var u=o[n],s=a[n],c=i?i[n]:null;if(!c){var l=t.buildCacheEntry({nodeData:u,queryId:r,queryAlias:n,queryRecord:a});return l?(e[n]=l,e):e}if(!Array.isArray(u))throw Error("Not implemented. "+JSON.stringify(u));return e[n]=e[n]||{proxyCache:{},idsOrIdInCurrentResult:[]},u.forEach((function(o){var i,u=null==(i=c.proxyCache[o.id])?void 0:i.proxy;if(u){var l,d=t.recursivelyUpdateProxyAndReturnNewCacheEntry({queryId:r,proxy:u,newRelationalData:t.getRelationalData({queryRecord:s,node:o}),relationalQueryRecord:s.relational||null,currentState:c.proxyCache[o.id]});e[n]={proxyCache:p({},e[n].proxyCache,(l={},l[o.id]=d,l)),idsOrIdInCurrentResult:[].concat(e[n].idsOrIdInCurrentResult,[o.id])}}else{var f,y=t.buildCacheEntry({nodeData:o,queryId:r,queryAlias:n,queryRecord:a});if(!y)return;e[n]={proxyCache:p({},e[n].proxyCache,(f={},f[o.id]=y.proxyCache[o.id],f)),idsOrIdInCurrentResult:[].concat(e[n].idsOrIdInCurrentResult,[o.id])}}})),e}),{}):null;return n.updateRelationalResults(u?this.getResultsFromState(u):null),{proxy:n,relationalState:u}},r.getRelationalData=function(e){return e.queryRecord.relational?Object.keys(e.queryRecord.relational).reduce((function(t,r){return t[r]=e.node[r],t}),{}):null},r.removeUnionSuffix=function(e){return e.includes("__rU__")?e.split("__rU__")[0]:e},r.getApplicableRelationalQueries=function(e){var t=this;return Object.keys(e.relationalQueries).reduce((function(r,n){var o,a;if(!n.includes("__rU__"))return p({},r,((o={})[n]=e.relationalQueries[n],o));var i=e.nodeData[n]?e.nodeData[n][0]:null;return i&&i.type!==e.relationalQueries[n].def.type?r:p({},r,((a={})[t.removeUnionSuffix(n)]=e.relationalQueries[n],a))}),{})},r.getDataFromResponse=function(e){return"id"in e.queryRecord||"oneToOne"in e.queryRecord?e.dataForThisAlias:e.dataForThisAlias.nodes},t}()}(this),this.optimisticUpdatesOrchestrator=new H,this.transaction=function(e,r){return function(o,a){var i={createNode:[],createNodes:[],updateNode:[],updateNodes:[],dropNode:[],createEdge:[],createEdges:[],dropEdge:[],dropEdges:[],replaceEdge:[],replaceEdges:[],updateEdge:[],updateEdges:[]},u=0,s=0;function c(e){if(!i[e.type])throw Error('No operationsByType array initialized for "'+e.type+'"');i[e.type].push("createNodes"===e.type?p({},e,{position:u+=1,nodes:e.nodes.map((function(e,t){return p({},e,{position:0===t?u:u+=1})}))}):"createNode"===e.type?p({},e,{position:u+=1}):"updateNodes"===e.type?p({},e,{position:s+=1,nodes:e.nodes.map((function(e,t){return p({},e,{position:0===t?s:s+=1})}))}):"updateNode"===e.type?p({},e,{position:s+=1}):e)}var l={createNode:function(e){var t=function(e){return p({type:"createNode",operationName:"CreateNodes"},e)}(e);return c(t),t},createNodes:function(e){var t=function(e){return p({type:"createNodes",operationName:"CreateNodes"},e)}(e);return c(t),t},updateNode:function(e){var t=function(e){return p({type:"updateNode",operationName:"UpdateNodes"},e)}(e),n=r.onUpdateRequested({id:e.data.id,payload:e.data}),o=n.onUpdateSuccessful,a=n.onUpdateFailed;return c(p({},t,{onSuccess:function(e){t.onSuccess&&t.onSuccess(e),o()},onFail:function(){t.onFail&&t.onFail(),a()}})),t},updateNodes:function(e){var t=function(e){return p({type:"updateNodes",operationName:"UpdateNodes"},e)}(e),n=e.nodes.map((function(e){return r.onUpdateRequested({id:e.data.id,payload:e.data})}));return c(p({},t,{nodes:t.nodes.map((function(e,t){return p({},e,{onSuccess:function(r){e.onSuccess&&e.onSuccess(r),n[t].onUpdateSuccessful()},onFail:function(){e.onFail&&e.onFail(),n[t].onUpdateFailed()}})}))})),t},dropNode:function(e){var t=function(e){return p({type:"dropNode",operationName:"DropNode"},e)}(e);return c(t),t},createEdge:function(e){var t=p({type:"createEdge"},e,{operationName:"AttachEdge"});return c(t),t},createEdges:function(e){var t={type:"createEdges",operationName:"AttachEdge",edges:e};return c(t),t},dropEdge:function(e){var t=p({type:"dropEdge",operationName:"DropEdge"},e);return c(t),t},dropEdges:function(e){var t={type:"dropEdges",operationName:"DropEdge",edges:e};return c(t),t},updateEdge:function(e){var t=p({type:"updateEdge",operationName:"UpdateEdge"},e);return c(t),t},updateEdges:function(e){var t={type:"updateEdges",operationName:"UpdateEdge",edges:e};return c(t),t},replaceEdge:function(e){var t=p({type:"replaceEdge",operationName:"ReplaceEdge"},e);return c(t),t},replaceEdges:function(e){var t={type:"replaceEdges",operationName:"ReplaceEdge",edges:e};return c(t),t}};function f(e){return t.sortBy(e,(function(e){return e.position}))}function y(e){return[].concat(function(e){if(!e.length)return[];var t=e.flatMap((function(e){if("createNode"===e.type)return e;if("createNodes"===e.type)return e.nodes;throw Error('Operation not recognized: "'+e+'"')})),r=Ye(e,"CreateNodes");return[n.gql(Ve||(Ve=_(["\n      mutation "," {\n        CreateNodes(\n          createOptions: [\n            ","\n          ]\n          transactional: true\n        ) {\n          id\n        }\n      }\n    "])),r,t.map(He).join("\n"))]}(f([].concat(e.createNode,e.createNodes))),function(e){if(!e.length)return[];var t=e.flatMap((function(e){if("updateNode"===e.type)return e.data;if("updateNodes"===e.type)return e.nodes.map((function(e){return e.data}));throw Error('Operation not recognized: "'+e+'"')})),r=Ye(e,"UpdateNodes"),o=t.reduce((function(e,t){var r=function e(t){return Object.entries(t).reduce((function(t,r){var n=r[0],o=r[1];return null==o?t.push(n):Array.isArray(o)||"object"!=typeof o||t.push.apply(t,e(o).map((function(e){return n+"__dot__"+e}))),t}),[])}(t);return r.length&&e.push(n.gql(Xe||(Xe=_(['\n        mutation {\n          DropProperties(\n            nodeIds: ["','"]\n            propertyNames: [',"]\n            transactional: true\n          )\n          { \n            id\n          }\n      }\n      "])),t.id,r.map((function(e){return'"'+e+'__dot__*"'})).join(","))),e}),[]);return[n.gql($e||($e=_(["\n        mutation "," {\n          UpdateNodes(\n            nodes: [\n              ","\n            ]\n            transactional: true\n          ) {\n            id\n          }\n        }\n      "])),r,t.map(ot).join("\n"))].concat(o)}(f([].concat(e.updateNode,e.updateNodes))),function(e){return e.length?e.map((function(e){if("dropNode"===e.type)return e;throw Error('Operation not recognized: "'+e+'"')})).map((function(e){var t=Ye([e],"DropNode");return n.gql(Ze||(Ze=_(["\n      mutation ",' {\n        DropNode(nodeId: "','", transactional: true)\n      }    \n    '])),t,e.id)})):[]}([].concat(e.dropNode)),function(e){return e.flatMap((function(e){if("createEdge"===e.type)return Ge(p({},e.edge,{name:e.name}));if("createEdges"===e.type)return e.edges.map((function(e){return Ge(e.edge)}));throw Error('Operation not recognized: "'+e+'"')}))}([].concat(e.createEdge,e.createEdges)),function(e){return e.flatMap((function(e){if("dropEdge"===e.type)return Je(p({},e.edge,{name:e.name}));if("dropEdges"===e.type)return e.edges.map((function(e){return Je(p({},e.edge,{name:e.name}))}));throw Error('Operation not recognized: "'+e+'"')}))}([].concat(e.dropEdge,e.dropEdges)),function(e){return e.flatMap((function(e){if("replaceEdge"===e.type)return ze(p({},e.edge,{name:e.name}));if("replaceEdges"===e.type)return e.edges.map((function(e){return ze(e.edge)}));throw Error('Operation not recognized: "'+e+'"')}))}([].concat(e.replaceEdge,e.replaceEdges)),function(e){return e.flatMap((function(e){if("updateEdge"===e.type)return We(p({},e.edge,{name:e.name}));if("updateEdges"===e.type)return e.edges.map((function(e){return We(e.edge)}));throw Error('Operation not recognized: "'+e+'"')}))}([].concat(e.updateEdge,e.updateEdges)))}var h=e.getToken({tokenName:(null==a?void 0:a.tokenName)||"default"});function g(e){var r=Object.entries(e).reduce((function(e,t){return t[1].forEach((function(t){e[t.operationName]=e.hasOwnProperty(t.operationName)?[].concat(e[t.operationName],[t]):[t]})),e}),{});return Object.entries(r).forEach((function(e){r[e[0]]=t.sortBy(e[1],(function(e){return e.position}))})),r}if(Array.isArray(o))return function(t){var r=t.filter((function(e){return e.callbackResult instanceof Promise})).map((function(e){return e.callbackResult}));function n(){return(n=d(X.mark((function n(){var o,a;return X.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,t.every((function(e){return e.token===t[0].token}))){n.next=4;break}throw new Error("transactionGroup - All grouped transactions must use the same authentication token.");case 4:if(!r.length){n.next=7;break}return n.next=7,Promise.all(r);case 7:return o=t.map((function(t){return e.gqlClient.mutate({mutations:y(t.operations),token:h})})),n.next=10,Promise.all(o);case 10:return(a=n.sent)&&a.forEach((function(e,r){m({executionResult:e,operationsByType:t[r].operations})})),n.abrupt("return",a.flat());case 15:throw n.prev=15,n.t0=n.catch(0),n.t0;case 18:case"end":return n.stop()}}),n,null,[[0,15]])})))).apply(this,arguments)}return{operations:i,execute:function(){return n.apply(this,arguments)},token:h}}(o);var v=o(l);function b(e){var t=g(e.operationsByType);Object.entries(t).forEach((function(e){var t=e[0];e[1].forEach((function(e){"CreateNodes"!==t&&"UpdateNodes"!==t||(e.hasOwnProperty("nodes")?e.nodes.forEach((function(e){e.hasOwnProperty("onFail")&&e.onFail()})):e.hasOwnProperty("onFail")&&e.onFail())}))}))}function m(e){var t=e.executionResult,r=g(e.operationsByType);!function e(t){t.forEach((function(t){if(Array.isArray(t))e(t);else{var n=t.data;Object.entries(r).forEach((function(e){var t=e[0],r=e[1];n.hasOwnProperty(t)&&r.forEach((function(e){if("CreateNodes"===t||"UpdateNodes"===t){var r=n[t];e.hasOwnProperty("nodes")?e.nodes.forEach((function(e){e.hasOwnProperty("onSuccess")&&e.onSuccess(r[e.position-1])})):e.hasOwnProperty("onSuccess")&&e.onSuccess(r[e.position-1])}}))}))}}))}(t),Object.entries(r).forEach((function(e){var t=e[0];"CreateNodes"!==t&&"UpdateNodes"!==t&&e[1].forEach((function(e){e.hasOwnProperty("onSuccess")?e.onSuccess():e.hasOwnProperty("edges")&&e.edges.forEach((function(e){e.hasOwnProperty("onSuccess")&&e.onSuccess()}))}))}))}function E(){return(E=d(X.mark((function t(){var r,n;return X.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"function"!=typeof o){t.next=5;break}if(!(v instanceof Promise)){t.next=5;break}return t.next=5,v;case 5:return r=y(i),t.next=8,e.gqlClient.mutate({mutations:r,token:h});case 8:return(n=t.sent)&&m({executionResult:n,operationsByType:i}),t.abrupt("return",n);case 13:throw t.prev=13,t.t0=t.catch(0),b({operationsByType:i}),t.t0;case 17:case"end":return t.stop()}}),t,null,[[0,13]])})))).apply(this,arguments)}return{operations:i,execute:function(){return E.apply(this,arguments)},callbackResult:v,token:h}}}(this,{onUpdateRequested:this.optimisticUpdatesOrchestrator.onUpdateRequested})}var r=e.prototype;return r.def=function(e){if(e.type.includes("-")||e.type.includes("."))throw new Error("Node types cannot include hyphens or dots");var t=Object.keys(e.properties).find((function(e){return Object.keys(Y).includes(e)}));if(t)throw new q({propName:t});var r,n=this.addDefaultNodeProperties(e.properties),o=this.DOFactory(p({},e,{properties:n}));return{_isNodeDef:!0,do:o,repository:(r={def:e,DOClass:o,onDOConstructed:this.optimisticUpdatesOrchestrator.onDOConstructed,onDODeleted:this.optimisticUpdatesOrchestrator.onDODeleted,onDataReceived:this.optimisticUpdatesOrchestrator.onPersistedDataReceived},new(function(){function e(){this.cached={}}var t=e.prototype;return t.onDataReceived=function(e){if(r.def.type!==e.type)throw Error("Attempted to query a node with an id belonging to a different type - Expected: "+r.def.type+" Received: "+e.type);var t=this.cached[e.id],n=this.parseDataFromBackend(e);if(!t){var o=new r.DOClass(n);this.cached[e.id]=o,r.onDOConstructed&&r.onDOConstructed(o)}r.onDataReceived({data:n,applyUpdateToDO:function(){t&&t.onDataReceived(n)}})},t.byId=function(e){var t=this.cached[e];if(!t)throw new S({nodeType:r.def.type,id:e});return t},t.onNodeDeleted=function(e){this.cached[e]&&(r.onDODeleted&&r.onDODeleted(this.cached[e]),delete this.cached[e])},t.parseDataFromBackend=function(e){var t=this,n={};return Object.keys(e).reduce((function(o,a){var i,u;if(Object.keys(B).includes(a))return p({},o,((u={})[a]=e[a],u));if(!(a.includes("__dot__")?Object.keys(r.def.properties).includes(a.split("__dot__")[0]):Object.keys(r.def.properties).includes(a)))return o;var s=null==(i=r.def.properties[a])?void 0:i.type,c=a.includes("__dot__")||s===exports.DATA_TYPES.object||s===exports.DATA_TYPES.maybeObject,l=s===exports.DATA_TYPES.record||s===exports.DATA_TYPES.maybeRecord,d=function(){if(c)return!1;var e=r.def.properties[a],t="function"==typeof e?e._default.type:e.type;return t===exports.DATA_TYPES.array||t===exports.DATA_TYPES.maybeArray}();if(c){var f=a.split("__dot__"),y=f[0],h=f.slice(1);if("__NULL__"===e[y]||null===e[y])return o[y]=null,o;if("string"==typeof e[y]&&e[y].startsWith("__JSON__"))try{n[y]=n[y]||G(e[y])}catch(t){throw new A({receivedData:e,message:'Could not parse json stored in old format for an object in the key "'+a+'"'})}return n[y]?(o[y]=o[y]||t.getOnlyQueriedData({allDataReceived:e,dataPreviouslyParsedForThisObject:n[y],rootProp:y}),o):(null==o[y]&&(o[y]={}),t.nest({nests:h,root:o[y],val:"__object__"===e[a]?{}:e[a]}),o)}if(l){if("string"==typeof e[a]&&e[a].startsWith("__JSON__"))o[a]=G(e[a]);else{if(null!=e[a])throw new A({receivedData:e,message:'Could not parse json stored in old format for a record in the key "'+a+'"'});o[a]=null}return o}return d?(o[a]=J(e[a]),o):(o[a]=e[a],o)}),{})},t.getOnlyQueriedData=function(e){var t=this;return Object.keys(e.allDataReceived).filter((function(t){return t.startsWith(e.rootProp+"__dot__")})).reduce((function(r,n){var o,a=n.split("__dot__"),i=a[0],u=a.slice(1);return t.nest({nests:u,root:r,val:t.getDataForProp({prop:n,object:(o={},o[i]=e.dataPreviouslyParsedForThisObject,o)})}),r}),{})},t.getDataForProp=function(e){if(null!=e.object){if(e.prop.includes("__dot__")){var t=e.prop.split("__dot__"),r=t[0],n=t.slice(1);return this.getDataForProp({object:e.object[r],prop:n.join("__dot__")})}return e.object[e.prop]}},t.nest=function(e){var t="__NULL__"===e.val?null:J(e.val);if(0===e.nests.length)e.root=t;else if(1===e.nests.length)e.root[e.nests[0]]=t;else{var r=e.nests,n=r[0],o=r.slice(1);null==e.root[n]?e.root[n]=null:this.nest({nests:o,root:e.root[n],val:t})}},e}())),type:e.type,data:n,computed:e.computed,relational:e.relational,generateMockData:e.generateMockData}},r.getToken=function(e){return this.tokens[e.tokenName]},r.setToken=function(e){this.tokens[e.tokenName]=e.token},r.clearTokens=function(){this.tokens={}},r.addDefaultNodeProperties=function(e){return p({},e,Y)},e}();Object.defineProperty(exports,"gql",{enumerable:!0,get:function(){return c.gql}}),exports.DEFAULT_NODE_PROPERTIES=Y,exports.DEFAULT_TOKEN_NAME="default",exports.Data=C,exports.FILTER_OPERATORS=K,exports.LoggingContext=tt,exports.MMGQL=at,exports.MMGQLContext=et,exports.MMGQLProvider=function(e){if(o.useContext(et))throw Error("Another instance of an MMGQLProvider was already detected higher up the render tree.\nHaving multiple instances of MMGQLProviders is not supported and may lead to unexpected results.");var t=o.useRef({}),r=o.useRef({}),n=o.useRef({}),a=o.useCallback((function(e,r){t.current[e]=p({},t.current[e],r)}),[]),i=o.useCallback((function(n){function o(){var e=t.current[n];e&&(e.unsub&&e.unsub(),delete t.current[n])}null!=e.subscriptionTTLMs?r.current[n]=setTimeout(o,e.subscriptionTTLMs):o()}),[e.subscriptionTTLMs]),u=o.useCallback((function(e){clearTimeout(r.current[e]),delete r.current[e]}),[]),s=o.useCallback((function(e,t){if(n.current[e]&&!t.silenceDuplicateSubIdErrors)throw Error(["A useSubscription hook was already mounted using the following subscription id:",e,"To fix this error, please specify a unique subscriptionId in the second argument of useSubscription","useSubscription(queryDefinitions, { subscriptionId })"].join("\n"));n.current[e]=!0}),[]),c=o.useCallback((function(e){delete n.current[e]}),[]);return o.createElement(et.Provider,{value:{mmGQLInstance:e.mmGQL,ongoingSubscriptionRecord:t.current,updateSubscriptionInfo:a,scheduleCleanup:i,cancelCleanup:u,onHookMount:s,onHookUnmount:c}},e.children)},exports.NODES_PROPERTY_KEY="nodes",exports.OBJECT_IDENTIFIER="__object__",exports.OBJECT_PROPERTY_SEPARATOR="__dot__",exports.PROPERTIES_QUERIED_FOR_ALL_NODES=B,exports.RELATIONAL_UNION_QUERY_SEPARATOR="__rU__",exports.UnsafeNoDuplicateSubIdErrorProvider=function(e){return o.createElement(tt.Provider,{value:{unsafe__silenceDuplicateSubIdErrors:!0}},e.children)},exports.array=function(e){var t="function"==typeof e?e._default:e;function r(e){return new C({type:exports.DATA_TYPES.array,parser:function(e){return e},boxedValue:t,defaultValue:e,isOptional:!1})}return r.optional=new C({type:exports.DATA_TYPES.maybeArray,parser:function(e){return e},boxedValue:t,isOptional:!0}),r._default=r([]),r},exports.boolean=U,exports.chance=$,exports.generateRandomBoolean=ee,exports.generateRandomNumber=te,exports.generateRandomString=Z,exports.getDefaultConfig=function(){return{gqlClient:nt({httpUrl:"http://bloom-app-loadbalancer-dev-524448015.us-west-2.elb.amazonaws.com/graphql/",wsUrl:"ws://bloom-app-loadbalancer-dev-524448015.us-west-2.elb.amazonaws.com/graphql/"}),generateMockData:!1}},exports.getGQLCLient=nt,exports.number=M,exports.object=V,exports.oneToMany=function(e){return function(t){return{def:e,_relationshipName:t._relationshipName,_relational:exports.RELATIONAL_TYPES.oneToMany,filter:t.filter,queryBuilderOpts:t}}},exports.oneToOne=function(e){return function(t){return{def:e,_relationshipName:t._relationshipName,_relational:exports.RELATIONAL_TYPES.oneToOne,queryBuilderOpts:t}}},exports.queryDefinition=function(e){return e},exports.record=Q,exports.string=L,exports.stringEnum=F,exports.useSubscription=function e(t,r){var n=o.useContext(et);if(!n)throw Error("You must wrap your app with an MMGQLProvider before using useSubscription.");var a={stack:""};if(Error.captureStackTrace(a,e),""===a.stack)throw Error("Error.captureStackTrace not supported");var i=(null==r?void 0:r.subscriptionId)||a.stack.split("\n")[1],u=function(e){var t=e.context.ongoingSubscriptionRecord[e.subscriptionId];return{results:(null==t?void 0:t.results)||Object.keys(e.queryDefinitions).reduce((function(e,t){return e[t]=null,e}),{}),error:null==t?void 0:t.error,querying:null==(null==t?void 0:t.querying)||t.querying}}({subscriptionId:i,context:n,queryDefinitions:t}),s=o.useState(u.results),c=s[0],l=s[1],d=o.useState(u.error),f=d[0],y=d[1],h=o.useState(u.querying),g=h[0],v=h[1],b=o.useContext(tt),m=null,_=null;try{m=function(e){var t=e.subscriptionId;e.context.ongoingSubscriptionRecord[t]||(e.context.ongoingSubscriptionRecord[t]={}),e.context.updateSubscriptionInfo(t,{onResults:e.handlers.onResults,onError:e.handlers.onError,setQuerying:e.handlers.setQuerying});var r,n=function(e){var t;return Object.entries(e).reduce((function(e,t){var r,n=t[1];return e[n&&"useSubOpts"in n&&null!=(null==(r=n.useSubOpts)?void 0:r.doNotSuspend)&&n.useSubOpts.doNotSuspend?rt.suspendDisabled:rt.suspendEnabled][t[0]]=n,e}),((t={})[rt.suspendEnabled]={},t[rt.suspendDisabled]={},t))}(e.queryDefinitions),o=n.suspendDisabled,a=n.suspendEnabled,i=Object.values(rt).map((function(e){return t+e}));function u(){return i.map((function(t){return e.context.ongoingSubscriptionRecord[t]}))}function s(t){var r,n,o,a=t.queryDefinitions,i=t.parentSubscriptionId,s=t.suspend,c=i+t.subscriptionSuffix,l=e.context.ongoingSubscriptionRecord[c];l||(e.context.ongoingSubscriptionRecord[c]={});var d=null==l?void 0:l.queryInfo;if(d){var f=Ie(t.queryDefinitions);Object.keys(f).length?n=ge({queryDefinitions:f,queryId:d.queryId}):(o=!0,e.context.updateSubscriptionInfo(c,{queryInfo:null}))}var y=o||n&&(!d||d.queryGQL!==n.queryGQL)||n&&(!d||d.queryParamsString!==n.queryParamsString);if(l&&!y)return l.suspendPromise;y&&l.unsub&&l.unsub();var h=(new Date).valueOf();e.context.updateSubscriptionInfo(c,{querying:!0,lastQueryTimestamp:h}),e.context.updateSubscriptionInfo(i,{querying:!0});var g=null==(r=e.context.ongoingSubscriptionRecord[i])?void 0:r.setQuerying;g&&g(!0),e.handlers.setQuerying(!0);var v=e.context.mmGQLInstance.subscribe(a,{batchKey:t.suspend?"suspended":"non-suspended",onPaginate:function(){var t=e.context.ongoingSubscriptionRecord[i];t.onResults&&t.onResults(p({},t.results))},onData:function(r){var n=r.results,o=e.context.ongoingSubscriptionRecord[c];if((null==o?void 0:o.lastQueryTimestamp)===h){var a=e.context.ongoingSubscriptionRecord[i];a.onResults&&a.onResults(p({},a.results,n)),e.context.updateSubscriptionInfo(t.parentSubscriptionId,{results:p({},a.results,n)})}},onError:function(r){var n=e.context.ongoingSubscriptionRecord[i];n.onError&&n.onError(r),e.context.updateSubscriptionInfo(t.parentSubscriptionId,{error:r})},onSubscriptionInitialized:function(t){e.context.updateSubscriptionInfo(c,{unsub:function(){return t()}}),e.context.updateSubscriptionInfo(i,{unsub:function(){u().forEach((function(e){return(null==e?void 0:e.unsub)&&e.unsub()}))}})},onQueryInfoConstructed:function(t){e.context.updateSubscriptionInfo(c,{queryInfo:t})}}).finally((function(){var t=e.context.ongoingSubscriptionRecord[c];if((null==t?void 0:t.lastQueryTimestamp)===h&&(e.context.updateSubscriptionInfo(c,{suspendPromise:void 0,querying:!1}),!u().some((function(e){return e&&e.querying})))){var r;e.context.updateSubscriptionInfo(i,{querying:!1});var n=null==(r=e.context.ongoingSubscriptionRecord[i])?void 0:r.setQuerying;n&&n(!1),e.handlers.setQuerying(!1)}}));return!l&&s?(e.context.updateSubscriptionInfo(c,{suspendPromise:v}),v):void 0}if(e.data.error)throw e.data.error;if(Object.keys(o).length)try{s({queryDefinitions:o,parentSubscriptionId:t,subscriptionSuffix:rt.suspendDisabled,suspend:!1})}catch(t){throw e.handlers.onError(t),t}if(Object.keys(a).length)try{r=s({queryDefinitions:a,parentSubscriptionId:t,subscriptionSuffix:rt.suspendEnabled,suspend:!0})}catch(t){throw e.handlers.onError(t),t}if(r)throw r;return{data:e.data.results,error:e.data.error,querying:e.data.querying,onHookUnmount:function(){e.context.onHookUnmount(t),e.context.scheduleCleanup(t),i.forEach((function(t){return e.context.scheduleCleanup(t)}))},onHookMount:function(){e.context.onHookMount(t,{silenceDuplicateSubIdErrors:e.silenceDuplicateSubIdErrors}),e.context.cancelCleanup(t),i.forEach((function(t){return e.context.cancelCleanup(t)}))}}}({context:n,subscriptionId:i,queryDefinitions:t,data:{results:c,error:f,querying:g},handlers:{onResults:l,onError:y,setQuerying:v},silenceDuplicateSubIdErrors:b.unsafe__silenceDuplicateSubIdErrors})}catch(e){_=e,m=null}if(o.useEffect((function(){var e;return null==(e=m)||e.onHookMount(),function(){var e;null==(e=m)||e.onHookUnmount()}}),[n,i]),f||_)throw f||_;return m};
//# sourceMappingURL=sm-js.cjs.production.min.js.map
